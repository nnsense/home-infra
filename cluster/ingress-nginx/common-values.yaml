controller:
  replicaCount: 2
  containerPort:
    http: 9080
    https: 9443
  service:
    type: LoadBalancer
    externalTrafficPolicy: Local
  metrics:
    enabled: true
  config:
    load-balance: ewma
    proxy-body-size: '0'
    ssl-protocols: TLSv1.3 TLSv1.2
    # Helps prevent auth loops
    force-ssl-redirect: true
    global-auth-url: https://gate.sko.ai/api/verify
    global-auth-signin: https://gate.sko.ai
    global-auth-cache-key: $cookie_authelia_session
    global-auth-snippet: |
      if ($cookie_authelia_session !~ "^.{32}$") {
        return 401;
      }
      # These headers stop the cache from working.
      proxy_ignore_headers Set-Cookie Expires Cache-Control;
    hsts: false
    location-snippet: |
      add_header X-Frame-Options SAMEORIGIN always;
      add_header X-Content-Type-Options nosniff always;
      add_header X-XSS-Protection "1; mode=block" always;
  extraArgs:
    http-port: 9080
    https-port: 9443
    default-ssl-certificate: cert-manager/sko-ai-tls
  resources:
    requests:
      memory: 250Mi
      cpu: 25m
    limits:
      memory: 500Mi
