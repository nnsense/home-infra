include:
 - project: doudous/ci-templates
   ref: main
   file: build.yaml

run:val:
  stage: test
  image: ${CI_REGISTRY_IMAGE}/val:rolling
  script:
    - validate

build:val:
  stage: build
  extends: .build_container
  rules:
    - changes:
      - ${CONTEXT}/*
      - .gitlab-ci.yaml
  variables:
    CONTEXT: validate
    CI_IMAGE_SUFFIX: /val
    PLATFORM: linux/amd64
    TAG: rolling
